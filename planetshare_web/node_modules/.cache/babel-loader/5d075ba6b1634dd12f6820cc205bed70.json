{"ast":null,"code":"'use strict';\n\nfunction _objectWithoutProperties(obj, keys) {\n  var target = {};\n\n  for (var i in obj) {\n    if (keys.indexOf(i) >= 0) continue;\n    if (!Object.prototype.hasOwnProperty.call(obj, i)) continue;\n    target[i] = obj[i];\n  }\n\n  return target;\n}\n\nvar Promise = require(\"promise\");\n\nvar _require = require('../utils/razorpay-utils'),\n    normalizeDate = _require.normalizeDate,\n    normalizeBoolean = _require.normalizeBoolean,\n    normalizeNotes = _require.normalizeNotes;\n\nvar ID_REQUIRED_MSG = '`payment_id` is mandatory';\n\nmodule.exports = function (api) {\n  return {\n    all: function all() {\n      var params = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var callback = arguments[1];\n      var from = params.from,\n          to = params.to,\n          count = params.count,\n          skip = params.skip;\n\n      if (from) {\n        from = normalizeDate(from);\n      }\n\n      if (to) {\n        to = normalizeDate(to);\n      }\n\n      count = Number(count) || 10;\n      skip = Number(skip) || 0;\n      return api.get({\n        url: '/payments',\n        data: {\n          from: from,\n          to: to,\n          count: count,\n          skip: skip\n        }\n      }, callback);\n    },\n    fetch: function fetch(paymentId, callback) {\n      if (!paymentId) {\n        throw new Error('`payment_id` is mandatory');\n      }\n\n      return api.get({\n        url: '/payments/' + paymentId\n      }, callback);\n    },\n    capture: function capture(paymentId, amount, currency, callback) {\n      if (!paymentId) {\n        throw new Error('`payment_id` is mandatory');\n      }\n\n      if (!amount) {\n        throw new Error('`amount` is mandatory');\n      }\n\n      var payload = {\n        amount: amount\n      };\n      /**\n       * For backward compatibility,\n       * the third argument can be a callback\n       * instead of currency.\n       * Set accordingly.\n       */\n\n      if (typeof currency === 'function' && !callback) {\n        callback = currency;\n        currency = undefined;\n      } else if (typeof currency === 'string') {\n        payload.currency = currency;\n      }\n\n      return api.post({\n        url: '/payments/' + paymentId + '/capture',\n        data: payload\n      }, callback);\n    },\n    refund: function refund(paymentId) {\n      var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var callback = arguments[2];\n\n      var notes = params.notes,\n          otherParams = _objectWithoutProperties(params, ['notes']);\n\n      if (!paymentId) {\n        throw new Error('`payment_id` is mandatory');\n      }\n\n      var data = Object.assign(otherParams, normalizeNotes(notes));\n      return api.post({\n        url: '/payments/' + paymentId + '/refund',\n        data: data\n      }, callback);\n    },\n    transfer: function transfer(paymentId) {\n      var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var callback = arguments[2];\n\n      if (!paymentId) {\n        throw new Error('`payment_id` is mandatory');\n      }\n\n      var notes = params.notes,\n          otherParams = _objectWithoutProperties(params, ['notes']);\n\n      var data = Object.assign(otherParams, normalizeNotes(notes));\n\n      if (data.transfers) {\n        var transfers = data.transfers;\n        transfers.forEach(function (transfer) {\n          transfer.on_hold = normalizeBoolean(!!transfer.on_hold);\n        });\n      }\n\n      return api.post({\n        url: '/payments/' + paymentId + '/transfers',\n        data: data\n      }, callback);\n    },\n    bankTransfer: function bankTransfer(paymentId, callback) {\n      if (!paymentId) {\n        return Promise.reject(ID_REQUIRED_MSG);\n      }\n\n      return api.get({\n        url: '/payments/' + paymentId + '/bank_transfer'\n      }, callback);\n    }\n  };\n};","map":null,"metadata":{},"sourceType":"script"}