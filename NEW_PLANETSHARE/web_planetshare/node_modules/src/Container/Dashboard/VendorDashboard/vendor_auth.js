import React from 'react';
import {Redirect} from 'react-router-dom';
import VendorRegistration from "./vendor_registration.js"
import {USERID,VENDORID,SELLER_VENDOR_STATUS,TAG} from '../../../url.js';
import ActivityLoader from 'react-loader-spinner';
import axios from 'axios';
const VendorAuth=(OldComponent)=>{
  class NewComponent extends React.Component{
    state={status:0,isLoading:false,loading_msg:'Please Wait'}
    componentDidMount()
    {
      this.getStatus();
    }
    getStatus=()=>{
      axios.post(SELLER_VENDOR_STATUS,{'user_id':localStorage.getItem('user_id'),'tag':TAG,'role':'vendor'}).then((res)=>{
        if(res.data.success==1)
        {
          this.setState({status:1,isLoading:true})
        }
        else {
          this.setState({isLoading:true})
        }
      }).catch((error)=>{

      })
    }
    render()
    {
      const {isLoading,status,loading_msg}=this.state;
      if(isLoading)
      {
        if(localStorage.getItem('user_id')!=0 && status)
        {
        return(<OldComponent {...this.props}/>)
        }
        else if(localStorage.getItem('user_id')!=0 && !status)
        {
        return(<VendorRegistration {...this.props}/>)
        }
        else {
          return(<Redirect to="/login"/>)
        }
      }
      else {
        return(<div class="container loader_cont"><ActivityLoader
          type="Triangle"
           color="black"
           height={100}
           width={100}
           />
           <h3>{loading_msg}</h3>
           </div>)
      }
    }
  }
  return NewComponent;
}

export default VendorAuth;
